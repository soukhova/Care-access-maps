tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
# tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM|> filter(med_copp_isc <= 100)) +
#filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
# tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM|> filter(med_copp_isc <= 50)) +
#filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
# tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM|> filter(med_copp_isc <= 60)) +
#filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
# tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM|> filter(med_copp_isc <= 70)) +
#filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
# tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM|> filter(med_copp_isc <= 80)) +
#filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
# tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM|> filter(med_copp_isc <= 90)) +
#filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
# tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM|> filter(med_copp_isc <= 100)) +
#filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
# tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM|> filter(med_copp_isc <= 120)) +
#filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
# tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM|> filter(med_copp_isc <= 145)) +
#filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
# tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM|> filter(med_copp_isc <= 30)) +
#filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
# tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM|> filter(med_copp_isc <= 50)) +
#filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
# tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM|> filter(med_copp_isc <= 60)) +
#filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
# tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM|> filter(med_copp_isc <= 80)) +
#filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
# tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM|> filter(med_copp_isc <= 100)) +
#filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
# tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
access_30_parcel_DA_HAM_selected <- access_30_parcel_DA_HAM |>
filter(
#lower hamilton central - high values DONE (Q4)
GeoUID == 35250434 | GeoUID == 35250424 | GeoUID == 35250422| GeoUID ==  35250427 |
#lower hamilton central - low values DONE (Q1)
GeoUID == 35250263|  GeoUID == 35250200| GeoUID == 35250857| GeoUID == 35250262 |
# mountain hamilton central - high values DONE
GeoUID == 35250379 |  GeoUID == 35250442| GeoUID == 35250378| GeoUID == 35250443|
# mountain hamilton central - low values
GeoUID == 35250583| GeoUID == 35250992| GeoUID == 35250989 | GeoUID == 35250582
)
care_dest_selected <-  st_intersection(care_dest,access_30_parcel_DA_HAM)
tm_shape(access_30_parcel_DA_HAM|> filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
# tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
access_30_parcel_DA_HAM_selected <- access_30_parcel_DA_HAM |>
filter(
#lower hamilton central - high values DONE (Q4)
GeoUID == 35250434 | GeoUID == 35250424 | GeoUID == 35250422| GeoUID ==  35250427 |
#lower hamilton central - low values DONE (Q1)
GeoUID == 35250263|  GeoUID == 35250200| GeoUID == 35250857| GeoUID == 35250262 |
# mountain hamilton central - high values DONE
GeoUID == 35250379 |  GeoUID == 35250442| GeoUID == 35250378| GeoUID == 35250443|
# mountain hamilton central - low values
GeoUID == 35250583| GeoUID == 35250992| GeoUID == 35250989 | GeoUID == 35250582
)
care_dest_selected <-  st_intersection(care_dest,access_30_parcel_DA_HAM)
tm_shape(access_30_parcel_DA_HAM|> filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
access_30_parcel_DA_HAM_selected <- access_30_parcel_DA_HAM |>
filter(
#lower hamilton central - high values DONE (Q4)
GeoUID == 35250434 | GeoUID == 35250424 | GeoUID == 35250422| GeoUID ==  35250427 |
#lower hamilton central - low values DONE (Q1) 35250265
GeoUID == 35250263|  GeoUID == 35250200| GeoUID == 35250857| GeoUID == 35250265 |
# mountain hamilton central - high values DONE
GeoUID == 35250379 |  GeoUID == 35250442| GeoUID == 35250378| GeoUID == 35250443|
# mountain hamilton central - low values
GeoUID == 35250583| GeoUID == 35250992| GeoUID == 35250989 | GeoUID == 35250582
)
care_dest_selected <-  st_intersection(care_dest,access_30_parcel_DA_HAM)
tmap_mode("view")
tm_shape(access_30_parcel_DA_HAM|> filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM|> filter(med_copp_isc <= 50))+
#filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM|> filter(med_copp_isc <= 70)) +
#filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tmap_mode("view")
tm_shape(access_30_parcel_DA_HAM|> filter(med_copp_isc <= 70)) +
#filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
access_30_parcel_DA_HAM_selected <- access_30_parcel_DA_HAM |>
filter(
#lower hamilton central - high values DONE (Q4)
GeoUID == 35250434 | GeoUID == 35250424 | GeoUID == 35250422| GeoUID ==  35250427 |
#lower hamilton central - low values DONE (Q1) 35250265
GeoUID == 35250263|  GeoUID == 35250200| GeoUID == 35250857| GeoUID == 35250265 |
# mountain hamilton central - high values DONE
GeoUID == 35250379 |  GeoUID == 35250442| GeoUID == 35250378| GeoUID == 35250443|
# mountain hamilton central - low values
GeoUID == 35250583| GeoUID == 35250992| GeoUID == 35250989 | GeoUID == 35250582
)
care_dest_selected <-  st_intersection(care_dest,access_30_parcel_DA_HAM)
tmap_mode("view")
tm_shape(access_30_parcel_DA_HAM|> filter(med_copp_isc <= 70)) +
#filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM |> filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
nb <- poly2nb(access_30_parcel_DA_HAM , queen = TRUE) # queen shares point or border
nbw <- nb2listw(include.self(nb), style = "B") #include self and the style must be binary as we do not calculate the spatial moving average for the neighborhood, but the total of the variable in the neighborhood.
lG <- localG(access_30_parcel_DA_HAM$med_copp_isc, nbw, alternative = "two.sided")
# adding p-values
lG <- as.numeric(lG)
lG <- data.frame(Gstar = lG, p.val = 2 * pnorm(abs(lG), lower.tail = FALSE))
access_30_parcel_DA_HAM <- cbind(access_30_parcel_DA_HAM,lG)
access_30_parcel_DA_HAM <- access_30_parcel_DA_HAM |>
mutate(Type = case_when(Gstar < 0 & p.val <= 0.05 ~ "Low Concentration",
Gstar > 0 & p.val <= 0.05 ~ "High Concentration",
TRUE ~ "Not Signicant"))
tm_shape(access_30_parcel_DA_HAM) + tm_fill(col = "Type", title = "",
palette =  c("red", "blue", "white")) +
tm_legend(text.size = 1)  + tm_borders(alpha = 0.5) +
tm_layout(frame = FALSE,  title = "Clusters")  +
tm_layout(legend.outside = TRUE)
nb <- poly2nb(access_15_parcel_DA_HAM , queen = TRUE) # queen shares point or border
nbw <- nb2listw(include.self(nb), style = "B") #include self and the style must be binary as we do not calculate the spatial moving average for the neighborhood, but the total of the variable in the neighborhood.
lG <- localG(access_15_parcel_DA_HAM$med_copp_isc, nbw, alternative = "two.sided")
# adding p-values
lG <- as.numeric(lG)
lG <- data.frame(Gstar = lG, p.val = 2 * pnorm(abs(lG), lower.tail = FALSE))
access_15_parcel_DA_HAM <- cbind(access_15_parcel_DA_HAM,lG)
access_15_parcel_DA_HAM <- access_15_parcel_DA_HAM |>
mutate(Type = case_when(Gstar < 0 & p.val <= 0.05 ~ "Low Concentration",
Gstar > 0 & p.val <= 0.05 ~ "High Concentration",
TRUE ~ "Not Signicant"))
tm_shape(access_15_parcel_DA_HAM) + tm_fill(col = "Type", title = "",
palette =  c("red", "blue", "white")) +
tm_legend(text.size = 1)  + tm_borders(alpha = 0.5) +
tm_layout(frame = FALSE,  title = "Clusters")  +
tm_layout(legend.outside = TRUE)
tmap_mode("view")
tm_shape(access_30_parcel_DA_HAM_selected) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"), alpha=0.3,border.alpha = 0.5,
breaks = c(2, 145, 257.8, 408.2, 807),
title = "Median # of care destinations (Quantiles)",
legend.is.portrait = FALSE,
popup.vars = c("med_copp_isc", "LICO-AT","Population")) +
tm_shape(care_dest_selected) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries) + tm_borders("black") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM_selected) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"), alpha=0.3,border.alpha = 0.5,
breaks = c(2, 145, 257.8, 408.2, 807),
title = "Median # of care destinations (Quantiles)",
legend.is.portrait = FALSE,
popup.vars = c("med_copp_isc", "LICO.AT","Population")) +
tm_shape(care_dest_selected) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries) + tm_borders("black") +
tm_legend(outside=TRUE)
access_30_parcel_DA_HAM_selected <- access_30_parcel_DA_HAM |>
filter(
#lower hamilton central - high values DONE (Q4)
GeoUID == 35250434 | GeoUID == 35250424 | GeoUID == 35250422| GeoUID ==  35250427 |
#lower hamilton central - low values DONE (Q1) 35250265
GeoUID == 35250263|  GeoUID == 35250200| GeoUID == 35250857| GeoUID == 35250265 |
# mountain hamilton central - high values
GeoUID == 35250379 |  GeoUID == 35250442| GeoUID == 35250378| GeoUID == 35250443|
# mountain hamilton central - low values
GeoUID == 35250583| GeoUID == 35250992| GeoUID == 35250989 | GeoUID == 35250582
)
care_dest_selected <-  st_intersection(care_dest,access_30_parcel_DA_HAM)
tmap_mode("view")
tm_shape(access_30_parcel_DA_HAM_selected) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"), alpha=0.3,border.alpha = 0.5,
breaks = c(2, 145, 257.8, 408.2, 807),
title = "Median # of care destinations (Quantiles)",
legend.is.portrait = FALSE,
popup.vars = c("med_copp_isc", "LICO.AT","Population")) +
tm_shape(care_dest_selected) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries) + tm_borders("black") +
tm_legend(outside=TRUE)
access_30_parcel_DA_HAM_selected <- access_30_parcel_DA_HAM |>
filter(
#lower hamilton central - high values DONE (Q4)
GeoUID == 35250434 | GeoUID == 35250424 | GeoUID == 35250422| GeoUID ==  35250427 |
#lower hamilton central - low values DONE (Q1) 35250265
GeoUID == 35250263|  GeoUID == 35250200| GeoUID == 35250857| GeoUID == 35250265 |
# mountain hamilton central - high values
GeoUID == 35250379 |  GeoUID == 35250442| GeoUID == 35250378| GeoUID == 35250443|
# mountain hamilton central - low values
GeoUID == 35250583| GeoUID == 35250992| GeoUID == 35250989 | GeoUID == 35250582
)
care_dest_selected <-  st_intersection(care_dest,access_30_parcel_DA_HAM_selected)
tmap_mode("view")
tm_shape(access_30_parcel_DA_HAM |> filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tmap_mode("view")
tm_shape(access_30_parcel_DA_HAM_selected) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"), alpha=0.3,border.alpha = 0.5,
breaks = c(2, 145, 257.8, 408.2, 807),
title = "Median # of care destinations (Quantiles)",
legend.is.portrait = FALSE,
popup.vars = c("med_copp_isc", "LICO.AT","Population")) +
tm_shape(care_dest_selected) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries) + tm_borders("black") +
tm_legend(outside=TRUE)
16+9+7+18
sf_use_s2(TRUE)
#care_dest_selected_200m <- care_dest_selected |> st_buffer(dist = 200)
care_dest_selected_400m <- care_dest_selected |> st_buffer(dist = 400)
sf_use_s2(FALSE)
main_roads_selected <- st_intersection(main_roads,care_dest_selected_400m |> select(c("ID"))|> st_union())
tmap_mode("view")
tm_shape(main_roads_selected |> mutate(car_speed = round(car_speed))) +
tm_lines(col = "car_speed", lwd=2, id = "car_speed", popup.vars = c("car_speed", "bicycle_lts", "street_class")) +
tm_shape(care_dest_selected) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"), alpha=0.8, legend.show = FALSE)
