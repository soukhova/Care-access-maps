palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
style = "quantile", n=4,
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
legend.is.portrait = FALSE) +
tm_shape(care_dest) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"), popup.vars = c("Care_Category", "Care_Category_Specific", "Name", "F_Address"))+
tm_shape(Community_Boundaries) + tm_borders("black") +
tm_legend(outside=TRUE)
sf_use_s2(FALSE)
Ward_Boundaries_HAM <- Ward_Boundaries |> filter(WARD == 1 |WARD == 2 |WARD == 3 |WARD == 4 |WARD == 5 |
WARD == 6 |WARD == 7 |WARD == 8 | WARD == 14)
Community_Boundaries_HAM <- Community_Boundaries |> filter(COMMUNITY_ == "Hamilton")
access_15_parcel_DA_HAM <-  st_intersection(access_15_parcel_DA, Community_Boundaries_HAM)
access_30_parcel_DA_HAM <-  st_intersection(access_30_parcel_DA, Community_Boundaries_HAM)
care_dest_HAM <-  st_intersection(care_dest,Community_Boundaries_HAM)
nb <- poly2nb(access_15_parcel_DA , queen = TRUE) # queen shares point or border
nbw <- nb2listw(nb, style = "W")
# Global Moran's I
gmoran <- moran.test(access_15_parcel_DA$med_copp_isc, nbw,
alternative = "greater")
gmoran
nb <- poly2nb(access_15_parcel_DA_HAM, queen = TRUE) # queen shares point or border
nbw <- nb2listw(nb, style = "W")
lmoran <- localmoran(access_15_parcel_DA_HAM$med_copp_isc, nbw, alternative = "two.sided")
access_15_parcel_DA_HAM$lmp <- lmoran[, 5] # p-values are in column 5
mp <- moran.plot(as.vector(scale(access_15_parcel_DA_HAM$med_copp_isc)), nbw)
access_15_parcel_DA_HAM$quadrant <- NA
# high-high
access_15_parcel_DA_HAM[(mp$x >= 0 & mp$wx >= 0) & (access_15_parcel_DA_HAM$lmp <= 0.05), "quadrant"]<- 1
# low-low
access_15_parcel_DA_HAM[(mp$x <= 0 & mp$wx <= 0) & (access_15_parcel_DA_HAM$lmp <= 0.05), "quadrant"]<- 2
# high-low
access_15_parcel_DA_HAM[(mp$x >= 0 & mp$wx <= 0) & (access_15_parcel_DA_HAM$lmp <= 0.05), "quadrant"]<- 3
# low-high
access_15_parcel_DA_HAM[(mp$x <= 0 & mp$wx >= 0) & (access_15_parcel_DA_HAM$lmp <= 0.05), "quadrant"]<- 4
# non-significant
access_15_parcel_DA_HAM[(access_15_parcel_DA_HAM$lmp > 0.05), "quadrant"] <- 5
tm_shape(access_15_parcel_DA_HAM) + tm_fill(col = "quadrant", title = "", breaks = c(1, 2, 3, 4, 5, 6),
palette =  c("red", "blue", "lightpink", "skyblue2", "white"),
labels = c("High-High", "Low-Low", "High-Low",
"Low-High", "Non-significant")) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_legend(text.size = 1)  + tm_borders(alpha = 0.5) +
tm_layout(frame = FALSE,  title = "Clusters")  +
tm_layout(legend.outside = TRUE)
tmap_mode("view")
tm_shape(access_15_parcel_DA_HAM |> filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(1,8, 17, 40, 177),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
library(shiny)
library(tmap)
library(sf)
library(dplyr)
library(tidyr)
library(r5r)
library(data.table)
library(spdep)
load(file="data/access_30_parcel_DA.rda")
load(file="data/access_15_parcel_DA.rda")
access_15_parcel_DA <- access_15_parcel_DA |> drop_na(GeoUID)
access_15_parcel_DA <- access_15_parcel_DA |>
rename("LICO-AT" = `v_CA21_1085: Prevalence of low income based on the Low-income cut-offs, after tax (LICO-AT) (%)`)
access_30_parcel_DA <- access_30_parcel_DA |> drop_na(GeoUID)
access_30_parcel_DA <- access_30_parcel_DA |>
rename("LICO-AT" = `v_CA21_1085: Prevalence of low income based on the Low-income cut-offs, after tax (LICO-AT) (%)`)
load("data/care_dest.rda")
Community_Boundaries <- st_read("data/Boundaries/Community_Boundaries.shp", quiet = TRUE)
Community_Boundaries <- st_transform(Community_Boundaries,crs = 4326)
Ward_Boundaries <- st_read("data/Boundaries/Ward_Boundaries.shp", quiet = TRUE)
Ward_Boundaries <- st_transform(Ward_Boundaries,crs = 4326)
care_dest <- care_dest |> st_set_crs(st_crs(Community_Boundaries))
# download.file(url = "https://transitfeeds.com/p/hamilton-street-railway/31/latest/download", destfile = file.path("data/Routing", "HSR-GTFS.zip"), mode = "wb") #downloading HSR latest GTFS file (15 August 2023)
#
r5r_core <- setup_r5("data/Routing/")
# extract OSM network
street_net <- street_network_to_sf(r5r_core)
main_roads <- subset(street_net$edges)
#, street_class %like% 'MOTORWAY|PRIMARY|SECONDARY'
tmap_mode("view")
p1 <- tm_shape(access_15_parcel_DA) +
tm_polygons("Population",
palette = "Greens",
style = "quantile", n=4, alpha=0.3,
border.alpha = 0.5,
title = "Population (Quantiles)",
legend.is.portrait = FALSE) +
tm_shape(care_dest) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries) + tm_borders("black") +
tm_legend(outside=TRUE)
p2 <-  tm_shape(access_15_parcel_DA) +
tm_polygons("LICO-AT",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
style = "quantile", n=4,
border.alpha = 0.5,
title = "LICO-AT Prevelance (Quantiles)",
legend.is.portrait = FALSE) +
tm_shape(care_dest) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries) + tm_borders("black") +
tm_legend(outside=TRUE)
tmap_arrange(p1, p2)
tmap_mode("view")
tm_shape(access_15_parcel_DA) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
style = "quantile", n=4,
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
legend.is.portrait = FALSE) +
tm_shape(care_dest) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"), popup.vars = c("Care_Category", "Care_Category_Specific", "Name", "F_Address"))+
tm_shape(Community_Boundaries) + tm_borders("black") +
tm_legend(outside=TRUE)
sf_use_s2(FALSE)
Ward_Boundaries_HAM <- Ward_Boundaries |> filter(WARD == 1 |WARD == 2 |WARD == 3 |WARD == 4 |WARD == 5 |
WARD == 6 |WARD == 7 |WARD == 8 | WARD == 14)
Community_Boundaries_HAM <- Community_Boundaries |> filter(COMMUNITY_ == "Hamilton")
access_15_parcel_DA_HAM <-  st_intersection(access_15_parcel_DA, Community_Boundaries_HAM)
access_30_parcel_DA_HAM <-  st_intersection(access_30_parcel_DA, Community_Boundaries_HAM)
care_dest_HAM <-  st_intersection(care_dest,Community_Boundaries_HAM)
nb <- poly2nb(access_15_parcel_DA , queen = TRUE) # queen shares point or border
nbw <- nb2listw(nb, style = "W")
# Global Moran's I
gmoran <- moran.test(access_15_parcel_DA$med_copp_isc, nbw,
alternative = "greater")
gmoran
nb <- poly2nb(access_15_parcel_DA_HAM, queen = TRUE) # queen shares point or border
nbw <- nb2listw(nb, style = "W")
lmoran <- localmoran(access_15_parcel_DA_HAM$med_copp_isc, nbw, alternative = "two.sided")
access_15_parcel_DA_HAM$lmp <- lmoran[, 5] # p-values are in column 5
mp <- moran.plot(as.vector(scale(access_15_parcel_DA_HAM$med_copp_isc)), nbw)
access_15_parcel_DA_HAM$quadrant <- NA
# high-high
access_15_parcel_DA_HAM[(mp$x >= 0 & mp$wx >= 0) & (access_15_parcel_DA_HAM$lmp <= 0.05), "quadrant"]<- 1
# low-low
access_15_parcel_DA_HAM[(mp$x <= 0 & mp$wx <= 0) & (access_15_parcel_DA_HAM$lmp <= 0.05), "quadrant"]<- 2
# high-low
access_15_parcel_DA_HAM[(mp$x >= 0 & mp$wx <= 0) & (access_15_parcel_DA_HAM$lmp <= 0.05), "quadrant"]<- 3
# low-high
access_15_parcel_DA_HAM[(mp$x <= 0 & mp$wx >= 0) & (access_15_parcel_DA_HAM$lmp <= 0.05), "quadrant"]<- 4
# non-significant
access_15_parcel_DA_HAM[(access_15_parcel_DA_HAM$lmp > 0.05), "quadrant"] <- 5
tm_shape(access_15_parcel_DA_HAM) + tm_fill(col = "quadrant", title = "", breaks = c(1, 2, 3, 4, 5, 6),
palette =  c("red", "blue", "lightpink", "skyblue2", "white"),
labels = c("High-High", "Low-Low", "High-Low",
"Low-High", "Non-significant")) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_legend(text.size = 1)  + tm_borders(alpha = 0.5) +
tm_layout(frame = FALSE,  title = "Clusters")  +
tm_layout(legend.outside = TRUE)
tmap_mode("view")
tm_shape(access_15_parcel_DA_HAM |> filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(1,8, 17, 40, 177),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
access_30_parcel_DA_HAM_selected <- access_30_parcel_DA_HAM |>
filter(
#lower hamilton central - high values DONE (Q4)
GeoUID == 35250434 | GeoUID == 35250424 | GeoUID == 35250422| GeoUID ==  35250427 |
#lower hamilton central - low values DONE (Q1) 35250265
GeoUID == 35250263|  GeoUID == 35250200| GeoUID == 35250857| GeoUID == 35250265 |
# mountain hamilton central - high values
GeoUID == 35250379 |  GeoUID == 35250442| GeoUID == 35250378| GeoUID == 35250443|
# mountain hamilton central - low values
GeoUID == 35250583| GeoUID == 35250992| GeoUID == 35250989 | GeoUID == 35250582
)
care_dest_selected <-  st_intersection(care_dest,access_30_parcel_DA_HAM_selected)
tmap_mode("view")
tm_shape(access_15_parcel_DA_HAM |> filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(1,8, 17, 40, 177),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tm_shape(access_15_parcel_DA_HAM |> filter(quadrant == 1 | quadrant == 2) |> filter(med_copp_isc >= 120) ) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(1,8, 17, 40, 177),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
library(shiny)
library(tmap)
library(sf)
library(dplyr)
library(tidyr)
library(r5r)
library(data.table)
library(spdep)
load(file="data/access_30_parcel_DA.rda")
load(file="data/access_15_parcel_DA.rda")
access_15_parcel_DA <- access_15_parcel_DA |> drop_na(GeoUID)
access_15_parcel_DA <- access_15_parcel_DA |>
rename("LICO-AT" = `v_CA21_1085: Prevalence of low income based on the Low-income cut-offs, after tax (LICO-AT) (%)`)
access_30_parcel_DA <- access_30_parcel_DA |> drop_na(GeoUID)
access_30_parcel_DA <- access_30_parcel_DA |>
rename("LICO-AT" = `v_CA21_1085: Prevalence of low income based on the Low-income cut-offs, after tax (LICO-AT) (%)`)
load("data/care_dest.rda")
Community_Boundaries <- st_read("data/Boundaries/Community_Boundaries.shp", quiet = TRUE)
Community_Boundaries <- st_transform(Community_Boundaries,crs = 4326)
Ward_Boundaries <- st_read("data/Boundaries/Ward_Boundaries.shp", quiet = TRUE)
Ward_Boundaries <- st_transform(Ward_Boundaries,crs = 4326)
care_dest <- care_dest |> st_set_crs(st_crs(Community_Boundaries))
# download.file(url = "https://transitfeeds.com/p/hamilton-street-railway/31/latest/download", destfile = file.path("data/Routing", "HSR-GTFS.zip"), mode = "wb") #downloading HSR latest GTFS file (15 August 2023)
#
r5r_core <- setup_r5("data/Routing/")
# extract OSM network
street_net <- street_network_to_sf(r5r_core)
main_roads <- subset(street_net$edges)
#, street_class %like% 'MOTORWAY|PRIMARY|SECONDARY'
tmap_mode("view")
p1 <- tm_shape(access_15_parcel_DA) +
tm_polygons("Population",
palette = "Greens",
style = "quantile", n=4, alpha=0.3,
border.alpha = 0.5,
title = "Population (Quantiles)",
legend.is.portrait = FALSE) +
tm_shape(care_dest) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries) + tm_borders("black") +
tm_legend(outside=TRUE)
p2 <-  tm_shape(access_15_parcel_DA) +
tm_polygons("LICO-AT",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
style = "quantile", n=4,
border.alpha = 0.5,
title = "LICO-AT Prevelance (Quantiles)",
legend.is.portrait = FALSE) +
tm_shape(care_dest) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries) + tm_borders("black") +
tm_legend(outside=TRUE)
tmap_arrange(p1, p2)
tmap_mode("view")
tm_shape(access_15_parcel_DA) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
style = "quantile", n=4,
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
legend.is.portrait = FALSE) +
tm_shape(care_dest) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"), popup.vars = c("Care_Category", "Care_Category_Specific", "Name", "F_Address"))+
tm_shape(Community_Boundaries) + tm_borders("black") +
tm_legend(outside=TRUE)
sf_use_s2(FALSE)
Ward_Boundaries_HAM <- Ward_Boundaries |> filter(WARD == 1 |WARD == 2 |WARD == 3 |WARD == 4 |WARD == 5 |
WARD == 6 |WARD == 7 |WARD == 8 | WARD == 14)
Community_Boundaries_HAM <- Community_Boundaries |> filter(COMMUNITY_ == "Hamilton")
access_15_parcel_DA_HAM <-  st_intersection(access_15_parcel_DA, Community_Boundaries_HAM)
access_30_parcel_DA_HAM <-  st_intersection(access_30_parcel_DA, Community_Boundaries_HAM)
care_dest_HAM <-  st_intersection(care_dest,Community_Boundaries_HAM)
nb <- poly2nb(access_15_parcel_DA , queen = TRUE) # queen shares point or border
nbw <- nb2listw(nb, style = "W")
# Global Moran's I
gmoran <- moran.test(access_15_parcel_DA$med_copp_isc, nbw,
alternative = "greater")
gmoran
nb <- poly2nb(access_15_parcel_DA_HAM, queen = TRUE) # queen shares point or border
nbw <- nb2listw(nb, style = "W")
lmoran <- localmoran(access_15_parcel_DA_HAM$med_copp_isc, nbw, alternative = "two.sided")
access_15_parcel_DA_HAM$lmp <- lmoran[, 5] # p-values are in column 5
mp <- moran.plot(as.vector(scale(access_15_parcel_DA_HAM$med_copp_isc)), nbw)
access_15_parcel_DA_HAM$quadrant <- NA
# high-high
access_15_parcel_DA_HAM[(mp$x >= 0 & mp$wx >= 0) & (access_15_parcel_DA_HAM$lmp <= 0.05), "quadrant"]<- 1
# low-low
access_15_parcel_DA_HAM[(mp$x <= 0 & mp$wx <= 0) & (access_15_parcel_DA_HAM$lmp <= 0.05), "quadrant"]<- 2
# high-low
access_15_parcel_DA_HAM[(mp$x >= 0 & mp$wx <= 0) & (access_15_parcel_DA_HAM$lmp <= 0.05), "quadrant"]<- 3
# low-high
access_15_parcel_DA_HAM[(mp$x <= 0 & mp$wx >= 0) & (access_15_parcel_DA_HAM$lmp <= 0.05), "quadrant"]<- 4
# non-significant
access_15_parcel_DA_HAM[(access_15_parcel_DA_HAM$lmp > 0.05), "quadrant"] <- 5
tm_shape(access_15_parcel_DA_HAM) + tm_fill(col = "quadrant", title = "", breaks = c(1, 2, 3, 4, 5, 6),
palette =  c("red", "blue", "lightpink", "skyblue2", "white"),
labels = c("High-High", "Low-Low", "High-Low",
"Low-High", "Non-significant")) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_legend(text.size = 1)  + tm_borders(alpha = 0.5) +
tm_layout(frame = FALSE,  title = "Clusters")  +
tm_layout(legend.outside = TRUE)
tmap_mode("view")
tm_shape(access_15_parcel_DA_HAM |> filter(quadrant == 1 | quadrant == 2) |> filter(med_copp_isc >= 120) ) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(1,8, 17, 40, 177),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
nb <- poly2nb(access_30_parcel_DA_HAM, queen = TRUE) # queen shares point or border
nbw <- nb2listw(nb, style = "W")
lmoran <- localmoran(access_30_parcel_DA_HAM$med_copp_isc, nbw, alternative = "two.sided")
access_30_parcel_DA_HAM$lmp <- lmoran[, 5] # p-values are in column 5
mp <- moran.plot(as.vector(scale(access_30_parcel_DA_HAM$med_copp_isc)), nbw)
access_30_parcel_DA_HAM$quadrant <- NA
# high-high
access_30_parcel_DA_HAM[(mp$x >= 0 & mp$wx >= 0) & (access_30_parcel_DA_HAM$lmp <= 0.05), "quadrant"]<- 1
# low-low
access_30_parcel_DA_HAM[(mp$x <= 0 & mp$wx <= 0) & (access_30_parcel_DA_HAM$lmp <= 0.05), "quadrant"]<- 2
# high-low
access_30_parcel_DA_HAM[(mp$x >= 0 & mp$wx <= 0) & (access_30_parcel_DA_HAM$lmp <= 0.05), "quadrant"]<- 3
# low-high
access_30_parcel_DA_HAM[(mp$x <= 0 & mp$wx >= 0) & (access_30_parcel_DA_HAM$lmp <= 0.05), "quadrant"]<- 4
# non-significant
access_30_parcel_DA_HAM[(access_30_parcel_DA_HAM$lmp > 0.05), "quadrant"] <- 5
tm_shape(access_30_parcel_DA_HAM) + tm_fill(col = "quadrant", title = "", breaks = c(1, 2, 3, 4, 5, 6),
palette =  c("red", "blue", "lightpink", "skyblue2", "white"),
labels = c("High-High", "Low-Low", "High-Low",
"Low-High", "Non-significant")) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_legend(text.size = 1)  + tm_borders(alpha = 0.5) +
tm_layout(frame = FALSE,  title = "Clusters")  +
tm_layout(legend.outside = TRUE)
access_30_parcel_DA_HAM_selected <- access_30_parcel_DA_HAM |>
filter(
#lower hamilton central - high values DONE (Q4)
GeoUID == 35250434 | GeoUID == 35250424 | GeoUID == 35250422| GeoUID ==  35250427 |
#lower hamilton central - low values DONE (Q1) 35250265
GeoUID == 35250263|  GeoUID == 35250200| GeoUID == 35250857| GeoUID == 35250265 |
# mountain hamilton central - high values
GeoUID == 35250379 |  GeoUID == 35250442| GeoUID == 35250378| GeoUID == 35250443|
# mountain hamilton central - low values
GeoUID == 35250583| GeoUID == 35250992| GeoUID == 35250989 | GeoUID == 35250582
)
care_dest_selected <-  st_intersection(care_dest,access_30_parcel_DA_HAM_selected)
tmap_mode("view")
tm_shape(access_30_parcel_DA_HAM |> filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tmap_mode("view")
tm_shape(access_30_parcel_DA_HAM_selected) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"), alpha=0.3,border.alpha = 0.5,
breaks = c(2, 145, 257.8, 408.2, 807),
title = "Median # of care destinations (Quantiles)",
legend.is.portrait = FALSE,
popup.vars = c("med_copp_isc", "LICO.AT","Population")) +
tm_shape(care_dest_selected) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("black") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM |> filter(quadrant == 1 | quadrant == 2) |> filter(med_copp_isc <= 49)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM |> filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
access_30_parcel_DA_HAM_selected <- access_30_parcel_DA_HAM |>
filter(
#lower hamilton central - high values DONE (Q4)
GeoUID == 35250434 | GeoUID == 35250424 | GeoUID == 35250422| GeoUID ==  35250427 | GeoUID == 35250854 |
#lower hamilton central - low values DONE (Q1) 35250265
GeoUID == 35251044|  GeoUID == 35250238| GeoUID == 35250248| GeoUID == 35250320 | GeoUID == 35250319 | GeoUID == 35250281 |
# mountain hamilton central - high values
GeoUID == 35250379 |  GeoUID == 35250442| GeoUID == 35250378| GeoUID == 35250443| GeoUID == 35250377 | GeoUID == 35250376 |
# mountain hamilton central - low values
GeoUID == 35250266| GeoUID == 35250265| GeoUID == 35250264 | GeoUID == 35250263 | GeoUID == 35250857 | GeoUID == 35250200
)
care_dest_selected <-  st_intersection(care_dest,access_30_parcel_DA_HAM_selected)
tmap_mode("view")
tm_shape(access_30_parcel_DA_HAM |> filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tmap_mode("view")
tm_shape(access_15_parcel_DA_HAM |> filter(quadrant == 1 | quadrant == 2) |> filter(med_copp_isc >= 120) ) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(1,8, 17, 40, 177),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
tmap_mode("view")
tm_shape(access_30_parcel_DA_HAM_selected) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"), alpha=0.3,border.alpha = 0.5,
breaks = c(2, 145, 257.8, 408.2, 807),
title = "Median # of care destinations (Quantiles)",
legend.is.portrait = FALSE,
popup.vars = c("med_copp_isc", "LICO.AT","Population")) +
tm_shape(care_dest_selected) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("black") +
tm_legend(outside=TRUE)
tm_shape(access_30_parcel_DA_HAM_selected) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"), alpha=0.3,border.alpha = 0.5,
breaks = c(2, 145, 257.8, 408.2, 807),
title = "Median # of care destinations (Quantiles)",
legend.is.portrait = FALSE,
popup.vars = c("med_copp_isc", "LICO.AT","Population")) +
tm_shape(care_dest_selected) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"),
popup.vars = c("Care_Category", "Care_Category_Specific", "Name", "F_Address"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("black") +
tm_legend(outside=TRUE)
tmap_mode("view")
tm_shape(access_30_parcel_DA_HAM |> filter(quadrant == 1 | quadrant == 2)) +
tm_polygons("med_copp_isc",
palette = c("darkred", "orange", "yellow", "green"),
alpha=0.3,
breaks = c(2, 145, 257.8, 408.2, 807),
border.alpha = 0.5,
title = "Median # of care destinations (Quantiles)",
popup.vars = c("med_copp_isc", "LICO.AT","Population") ) +
tm_shape(Ward_Boundaries_HAM) + tm_borders(col = "grey20")+
tm_shape(access_30_parcel_DA_HAM_selected) + tm_borders(col="black", lwd=3)+
tm_shape(care_dest_HAM) +
tm_dots(col = "Care_Category", palette = c("brown","blue","purple","green","cyan"), popup.vars = c("Care_Category", "Care_Category_Specific", "Name", "F_Address"))+
tm_shape(Community_Boundaries_HAM) + tm_borders("grey") +
tm_legend(outside=TRUE)
